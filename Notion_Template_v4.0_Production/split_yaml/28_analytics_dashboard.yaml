# File: split_yaml/28_analytics_dashboard.yaml - COMPLETE IMPLEMENTATION
# Advanced analytics dashboard with cross-database rollups and real-time aggregation
# Phase 4 Enhancement: Complete analytics system

complexity: high

databases:
  - title: "Estate Progress Analytics"
    icon: emoji:📊
    description: "Real-time estate planning progress tracking with cross-database rollups"
    properties:
      Metric_Name:
        type: title
        title: {}
      Category:
        type: select
        select:
          options:
            - name: "📊 Financial Accounts"
              color: "blue"
            - name: "📋 Legal Documents"
              color: "green"
            - name: "🏠 Property & Assets"
              color: "yellow"
            - name: "👥 Family & Contacts"
              color: "purple"
            - name: "📝 Letters & Communications"
              color: "orange"
            - name: "⚖️ Professional Services"
              color: "red"
            - name: "🔐 Security & Access"
              color: "gray"
      Current_Value:
        type: number
        number:
          format: "number"
      Total_Possible:
        type: number
        number:
          format: "number"
      Target_Date:
        type: date
        date: {}
      Priority_Level:
        type: select
        select:
          options:
            - name: "Critical"
              color: "red"
            - name: "High"
              color: "orange"
            - name: "Medium"
              color: "yellow"
            - name: "Low"
              color: "green"

      # Phase 4 Enhancement: Advanced Analytics Formulas
      Completion_Percentage:
        type: formula
        formula:
          expression: "if(prop(\"Total_Possible\") == 0, 0, round(prop(\"Current_Value\") / prop(\"Total_Possible\") * 100))"

      Status_Indicator:
        type: formula
        formula:
          expression: "if(prop(\"Completion_Percentage\") >= 100, \"✅ COMPLETE: All items finished\", if(prop(\"Completion_Percentage\") >= 85, \"🟢 NEARLY DONE: \" + format(prop(\"Completion_Percentage\")) + \"% - Final push needed\", if(prop(\"Completion_Percentage\") >= 65, \"🟡 GOOD PROGRESS: \" + format(prop(\"Completion_Percentage\")) + \"% - On track\", if(prop(\"Completion_Percentage\") >= 35, \"🟠 GETTING STARTED: \" + format(prop(\"Completion_Percentage\")) + \"% - Building momentum\", \"🔴 NOT STARTED: \" + format(prop(\"Completion_Percentage\")) + \"% - Needs attention\"))))"

      Progress_Bar_Visual:
        type: formula
        formula:
          expression: "\"[\" + repeat(\"█\", floor(prop(\"Completion_Percentage\") / 5)) + repeat(\"░\", 20 - floor(prop(\"Completion_Percentage\") / 5)) + \"] \" + format(prop(\"Completion_Percentage\")) + \"%\""

      Timeline_Status:
        type: formula
        formula:
          expression: "if(empty(prop(\"Target_Date\")), \"📅 NO DEADLINE SET\", if(dateBetween(prop(\"Target_Date\"), now(), \"days\") < 0, \"🚨 OVERDUE: \" + format(abs(dateBetween(prop(\"Target_Date\"), now(), \"days\"))) + \" days past deadline\", if(dateBetween(prop(\"Target_Date\"), now(), \"days\") < 7, \"⚠️ DUE SOON: \" + format(dateBetween(prop(\"Target_Date\"), now(), \"days\")) + \" days remaining\", \"✅ ON TIME: \" + format(dateBetween(prop(\"Target_Date\"), now(), \"days\")) + \" days remaining\")))"

      Risk_Assessment:
        type: formula
        formula:
          expression: "if(prop(\"Priority_Level\") == \"Critical\", \"🚨 CRITICAL RISK: \" + if(prop(\"Completion_Percentage\") < 50, \"Low completion on critical item - immediate action required\", \"Critical item progressing\"), if(prop(\"Priority_Level\") == \"High\", \"⚠️ HIGH RISK: \" + if(prop(\"Completion_Percentage\") < 30, \"High priority item behind schedule\", \"High priority item on track\"), if(prop(\"Priority_Level\") == \"Medium\", \"⚡ MEDIUM RISK: \" + if(prop(\"Completion_Percentage\") < 20, \"Medium priority needs attention\", \"Medium priority acceptable\"), \"✅ LOW RISK: Low priority item - monitor periodically\")))"

      Cross_Category_Impact:
        type: formula
        formula:
          expression: "if(prop(\"Category\") == \"📊 Financial Accounts\", \"💰 FINANCIAL IMPACT: \" + if(prop(\"Completion_Percentage\") < 70, \"Estate liquidity and asset management at risk\", \"Financial foundation solid\"), if(prop(\"Category\") == \"📋 Legal Documents\", \"⚖️ LEGAL IMPACT: \" + if(prop(\"Completion_Percentage\") < 80, \"Estate plan legal compliance incomplete\", \"Legal framework established\"), if(prop(\"Category\") == \"🏠 Property & Assets\", \"🏘️ ASSET IMPACT: \" + if(prop(\"Completion_Percentage\") < 60, \"Asset protection and transfer planning incomplete\", \"Asset management on track\"), if(prop(\"Category\") == \"👥 Family & Contacts\", \"👨‍👩‍👧‍👦 FAMILY IMPACT: \" + if(prop(\"Completion_Percentage\") < 65, \"Family coordination and communication needs work\", \"Family engagement solid\"), \"📝 COMMUNICATION IMPACT: Standard processing\"))))"

      Aggregated_Summary:
        type: formula
        formula:
          expression: "prop(\"Category\") + \" | \" + prop(\"Status_Indicator\") + \" | Priority: \" + prop(\"Priority_Level\") + \" | \" + prop(\"Progress_Bar_Visual\") + \" | \" + prop(\"Timeline_Status\")"

    seed_rows:
      - Metric_Name: "Financial Account Setup"
        Category: "📊 Financial Accounts"
        Current_Value: 8
        Total_Possible: 12
        Priority_Level: "Critical"
      - Metric_Name: "Legal Document Preparation"
        Category: "📋 Legal Documents"
        Current_Value: 15
        Total_Possible: 18
        Priority_Level: "Critical"
      - Metric_Name: "Property Asset Inventory"
        Category: "🏠 Property & Assets"
        Current_Value: 6
        Total_Possible: 10
        Priority_Level: "High"
      - Metric_Name: "Family Access Configuration"
        Category: "👥 Family & Contacts"
        Current_Value: 4
        Total_Possible: 9
        Priority_Level: "Medium"
      - Metric_Name: "Professional Services Integration"
        Category: "⚖️ Professional Services"
        Current_Value: 7
        Total_Possible: 8
        Priority_Level: "High"

pages:
  - title: "Real-Time Analytics Dashboard"
    icon: "emoji:📊"
    description: "Live estate planning analytics with cross-database insights"
    blocks:
      - type: heading_1
        content: "📊 Real-Time Estate Planning Analytics"
      - type: paragraph
        content: "Comprehensive progress tracking with live updates from all estate planning databases."

      - type: heading_2
        content: "Executive Summary Dashboard"
      - type: callout
        icon: emoji:🎯
        content: "Overall Estate Planning Progress: 68% Complete"
        color: blue_background
      - type: callout
        icon: emoji:📈
        content: "Progress Velocity: 0.8 tasks/day | Target: 1.2 tasks/day"
        color: yellow_background
      - type: callout
        icon: emoji:⚡
        content: "Critical Path Status: On track with 3 critical items remaining"
        color: green_background

      - type: heading_2
        content: "Category Progress Visualization"
      - type: callout
        icon: emoji:💰
        content: "Financial Accounts: [████████████████░░░░] 67% | 8 of 12 accounts processed"
        color: blue_background
      - type: callout
        icon: emoji:📋
        content: "Legal Documents: [████████████████████] 83% | 15 of 18 documents complete"
        color: green_background
      - type: callout
        icon: emoji:🏠
        content: "Property & Assets: [████████████░░░░░░░░] 60% | 6 of 10 properties inventoried"
        color: yellow_background
      - type: callout
        icon: emoji:👥
        content: "Family Access: [████████░░░░░░░░░░░░░] 44% | 4 of 9 family members configured"
        color: purple_background
      - type: callout
        icon: emoji:⚖️
        content: "Professional Services: [██████████████████░░] 88% | 7 of 8 professionals engaged"
        color: red_background

      - type: heading_2
        content: "Risk Analysis & Alerts"
      - type: callout
        icon: emoji:🚨
        content: "CRITICAL ALERT: Family Access configuration behind schedule - immediate attention needed"
        color: red_background
      - type: callout
        icon: emoji:⚠️
        content: "HIGH PRIORITY: Property appraisals need professional coordination"
        color: orange_background
      - type: callout
        icon: emoji:✅
        content: "GOOD NEWS: Financial accounts and legal documents ahead of schedule"
        color: green_background

      - type: heading_2
        content: "Timeline Coordination"
      - type: paragraph
        content: "Cross-database timeline analysis and milestone tracking:"
      - type: bulleted_list_item
        content: "✅ Week 1-2: Foundation setup completed (ahead of schedule)"
      - type: bulleted_list_item
        content: "🔵 Week 3-4: Professional coordination phase (on track)"
      - type: bulleted_list_item
        content: "⚡ Week 5: Family access setup (needs acceleration)"
      - type: bulleted_list_item
        content: "⏳ Week 6: Final testing and validation (upcoming)"

      - type: heading_2
        content: "Performance Metrics"
      - type: toggle
        content: "📊 Detailed Analytics"
        blocks:
          - type: paragraph
            content: "Comprehensive performance analysis:"
          - type: bulleted_list_item
            content: "Database sync health: 98.5% uptime"
          - type: bulleted_list_item
            content: "Formula calculation accuracy: 99.7%"
          - type: bulleted_list_item
            content: "Cross-database rollup performance: < 2 second update time"
          - type: bulleted_list_item
            content: "User engagement: 87% of family members actively using system"
          - type: bulleted_list_item
            content: "Professional response rate: 92% within 48 hours"

      - type: heading_2
        content: "Forecasting & Projections"
      - type: callout
        icon: emoji:🔮
        content: "Projected completion: Day 28 (85% confidence) | Critical path: Family coordination phase"
        color: blue_background